{
    "id": "db49e6c4-435e-41e2-94b4-7713a8b41a8c",
    "name": "KuduCommandLine",
    "friendlyName": "Kudu command line",
    "description": "Execute a shell command using the Command endpoint in the Kudu rest api",
    "author": "Arjan van Rijn",
    "helpMarkDown": "Kudu is the deployment engine behind the Azure Appservice. This task can be used to execute arbitrary shell commands using the Command endpoint in the Kudu rest api. This is useful for running Package manager restore commands after deployment. [Deployment-credentials](https://github.com/projectkudu/kudu/wiki/Deployment-credentials), [Kudu-rest-api](https://github.com/projectkudu/kudu/wiki/REST-API#command)",
    "category": "Deploy",
    "visibility": [
        "Build",
        "Release"
    ],
    "demands": [
        "DotNetFramework"
    ],
    "version": {
        "Major": 2,
        "Minor": 0,
        "Patch": 2
    },
    "minimumAgentVersion": "1.95.0",
    "groups": [
        {
            "name": "advanced",
            "displayName": "Advanced",
            "isExpanded": false
        }
    ],    
    "inputs": [
        {
            "name": "ConnectedServiceName",
            "type": "connectedService:AzureRM",
            "label": "AzureRM Subscription",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Select the Azure Resource Manager subscription for the deployment."
        },
        {
            "name": "WebAppName",
            "type": "pickList",
            "label": "Web App Name",
            "defaultValue": "",
            "required": true,
            "properties": {
                "EditableOptions": "True"
            },
            "helpMarkDown": "Enter or Select the name of an existing AzureRM Web Application."
        },
        {
            "name": "ManageSlotFlag",
            "type": "boolean",
            "label": "Manage Slot",
            "defaultValue": "false",
            "required": false,
            "helpMarkDown": "Select the option to Manage an existing slot other than the Production slot. If this option is not selected the Task is executed against the Production slot."
        },
        {
            "name": "ResourceGroupName",
            "type": "pickList",
            "label": "Resource Group",
            "defaultValue": "",
            "required": true,
            "properties": {
                "EditableOptions": "True"
            },
            "helpMarkDown": "Enter or Select the Azure Resource Group that contains the AzureRM Web App specified above.",
            "visibleRule": "ManageSlotFlag = true"
        },
        {
            "name": "SlotName",
            "type": "pickList",
            "label": "Slot",
            "defaultValue": "",
            "required": true,
            "properties": {
                "EditableOptions": "True"
            },
            "helpMarkDown": "Enter or Select an existing Slot other than the Production slot.",
            "visibleRule": "ManageSlotFlag = true"
        },
        {
            "name": "Command",
            "type": "string",
            "label": "Command",
            "required": true,
            "helpMarkDown": "The command to run in the [command  rest api](https://github.com/projectkudu/kudu/wiki/REST-API#command)"
        },
        {
            "name": "Dir",
            "type": "string",
            "label": "Dir",
            "defaultValue": "site/wwwroot",
            "required": true,
            "helpMarkDown": "The working directory for the command"
        },        
        {
            "name": "Timeout",
            "type": "string",
            "label": "Timeout",
            "required": true,
            "defaultValue": "1800",
            "helpMarkDown": "The webrequest timeout",
            "groupName": "advanced"
        }           
    ],
    "instanceNameFormat": "Kudu run $(command)",
    "execution": {
        "PowerShell3": {
            "target": "$(currentDirectory)\\Invoke-KuduCommandLine.ps1"
        }
    }
}